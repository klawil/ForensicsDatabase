<html>
<head><title>Enter Tournament Information</title>
<style>
input[type="number"] {
   width:40px;
}
</style>
</head>
<body>
<form id="EntryID" action="TournamentUpdate.php">
<h1><div id="Header">Select a Tournament</div></h1>
<h3 id="Message"></h3>
<div id="Tourneys"></div><br>
<div id="Students"></div><br>
<div id="Events"></div><br>
<div id="Rounds"></div>
<div id="info" style="display: none;">
    <input type="checkbox" value="broke" onchange="OutsHideShow();" id="broke">Broke<br>
    <input type="checkbox" value="StateQual" id="Qual">Qualified for State<br>
</div>
<div id="Outs" style="display: none;"></div>
<div id="submit" style="display: none;"><input type="submit" onclick="SubmitInfo();" value="Submit"></div>
</form>
<script>
function SubmitInfo() {
    event.preventDefault();
    x = 3;
    RString = "";
    while (document.getElementById("EntryID").elements[x].value != "broke") {
        RString = RString + document.getElementById("EntryID").elements[x].id + "=" + document.getElementById("EntryID").elements[x].value + "&";
        if ( document.getElementById("EntryID").elements[x].value == "" ) {
            document.getElementById("Message").innerHTML = "Enter value for " + document.getElementById("EntryID").elements[x].id;
            return;
        }
        x = x + 1;
    }
    y = x - 1;
    IString = "";
    for ( x = 0; x < 3; x++) {
        IString = IString + document.getElementById("EntryID").elements[x].id + "=" + document.getElementById("EntryID").elements[x].value + "&";
    }
    BString = "";
    if ( document.getElementById("broke").checked ) {
        IString = IString + "broke=1&";
        z = y + 3;
        for ( x = z; x < document.getElementById("EntryID").elements.length - 1; x++ ) {
            BString = BString + document.getElementById("EntryID").elements[x].id + "=" + document.getElementById("EntryID").elements[x].value + "&";
            if ( document.getElementById("EntryID").elements[x].value == "" ) {
                document.getElementById("Message").innerHTML = "Enter value for " + document.getElementById("EntryID").elements[x].id;
                return;
            }
        }
    } else {
        IString = IString + "broke=0&";
    }
    if ( document.getElementById("Qual").checked ) {
        IString = IString + "qual=1";
    } else {
        IString = IString + "qual=0";
    }
    document.getElementById("Message").innerHTML = "";//RString + BString + IString;
    document.getElementById("Message").innerHTML = "Submitting...";
    if ( window.XMLHttpRequest ) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("POST","TournamentUpdate.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send(RString + BString + IString);
    response = xmlhttp.responseText;
    if ( response == "true" ) {
        document.getElementById("Message").innerHTML = "Submitted successfully.";
        document.getElementById("EntryID").reset();
        OutsHideShow();
    } else {
        document.getElementById("Message").innerHTML = response;
    }
}
function Tournaments() {
    document.getElementById("Tourneys").innerHTML = "Loading...";
    if ( window.XMLHttpRequest ) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("POST","TournamentInfo.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("Tournaments=1");
    response = xmlhttp.responseText;
    document.getElementById("Tourneys").innerHTML = response + '   <input type="button" value="Select" onclick="MakePage();">';
}
function Students() {
    if ( window.XMLHttpRequest ) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("POST","TournamentInfo.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("Students=1");
    response = "";
    response = xmlhttp.responseText;
    document.getElementById("Students").innerHTML = response;
}
function Events() {
    if ( window.XMLHttpRequest ) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("POST","TournamentInfo.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("Events=1");
    response = "";
    response = xmlhttp.responseText;
    document.getElementById("Events").innerHTML = response;
}
function GetInfo(TID){
    if ( window.XMLHttpRequest ) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("POST","TournamentInfo.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("TID=" + TID);
    response = "";
    response = xmlhttp.responseText;
    return response;
}
function MakePage(){
    document.getElementById("Header").innerHTML = document.getElementById("Tournament").options[document.getElementById("Tournament").selectedIndex].text;
    Students();
    Events();
    TInfo = GetInfo(document.getElementById("Tournament").options[document.getElementById("Tournament").selectedIndex].value);
    InfoSplit = TInfo.split("|");
    NumRounds = InfoSplit[0];
    NumJudge = InfoSplit[1];
    HTMLString = ""
    for ( x = 1; x <= NumRounds; x++ ) {
        HTMLString = HTMLString + "Round " + x + ': <input type="number" id="R' + x + 'R"><input type="number" id="R' + x + 'Q"><br>';
    }
    document.getElementById("Rounds").innerHTML = HTMLString;
    HTMLString = ""
    for ( x = 1; x <= NumJudge; x++ ) {
        HTMLString = HTMLString + "Judge " + x + ': <input type="number" id="J' + x + 'R"><input type="number" id="J' + x + 'Q"><br>';
    }
    HTMLString = HTMLString + 'Place: <input type="number" id="place"><br>';
    document.getElementById("Outs").innerHTML = HTMLString;
    document.getElementById("info").style.display = 'inline';
    document.getElementById("submit").style.display = 'inline';
    document.getElementById("Tourneys").innerHTML = '<input type="hidden" id="TID" value="' + document.getElementById("Tournament").options[document.getElementById("Tournament").selectedIndex].value + '">';
}
function OutsHideShow() {
    if ( document.getElementById("broke").checked ) {
        document.getElementById("Outs").style.display = 'inline';
    } else {
        document.getElementById("Outs").style.display = 'none';
    }
}
Tournaments();
</script>
</body>
</html>